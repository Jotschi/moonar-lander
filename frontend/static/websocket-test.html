<!DOCTYPE html>
<html>

<body>
    <script>
        (function () {
            "use strict";
            // https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_client_applications
            function error(err) { console.error(err); }
            var server = new WebSocket("ws://localhost:4711");
            server.onmessage = function (msg) { console.log("SERVER: " + msg.data); };
            server.onerror = error;

            setTimeout(function () {
                var client = new WebSocket("ws://localhost:4711");
                client.onmessage = function (msg) {
                    // let data = JSON.parse(msg.data);
                    // if (data.token) client.token = data.token;
                    console.log(msg);
                };
                client.onerror = error;
                client.onopen = function () {
                    console.log('sending');
                    client.send("bla");
                };
            }, 1000);
        })();
    </script>
</body>

</html>